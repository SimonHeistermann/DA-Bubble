<div class="message-container">
    <div class="message ">
         @for (message of messages; let index = $index; track message.id) {
             @if (allUsers.length) {
                 @if (message.createdAt) {
                    @if (shouldShowDateDivider(index)) {
                        <div class="data-divider">
                            <div class="divider"></div>
                                <div class="data">{{ dateService.getGermanFullDate(message.createdAt) }}</div>
                        
                        </div>
                    }
                 }
                <div class="message-body" [class.active]="clickedMessageIndex === 0" [class.reversed]="currentUser?.id === message.authorID">
                    <div class="avatar">
                        <img [src]="findURLByUserId(message.authorID)">
                    </div>
                    <div class="message-content">
                        <div class="message-content-top">
                            <span class="name">{{ message.authorName }}</span>
                            @if (message.createdAt) {
                                 <span class="time">{{ dateService.getHoursAndMinutes(message.createdAt) }} Uhr</span>
                            }
                           
                        </div>
                        <div class="message-content-middle">
                            <p>
                                {{ message.content }}
                            </p>
                        </div>
                        <div class="message-content-bottom">
                            <div class="emoji-wrapper">
                                <div class="emoji-picker-trigger pointer" #emojiTriggerAtLeft (click)="showEmojiPicker(0, 'left')"></div>
                                <div class="emojis">
                                    <div class="emoji-div pointer">
                                        <app-emoji [emoji]="'thumbs_up'"></app-emoji>
                                        <!-- <span class="emoji-code">üëç</span> -->
                                        <span>1</span>
                                    </div>
                                    <div class="emoji-div pointer">
                                        <!-- <app-emoji [emoji]="'rocket'"></app-emoji> -->
                                        <span class="emoji-code">üëã</span>
                                        <span>1</span>
                                    </div>
                                </div>
                            </div>
                            <div class="thread-wrapper">
                                <span class="answer pointer">
                                    {{ message.threadCount }} 
                                    <span>
                                    Antwort<ng-container *ngIf="message.threadCount > 1">en</ng-container>
                                    </span>
                                </span>
                                <span class="last-answer-time">Letzte Antwort 14:56</span>
                            </div>
                        </div>
                    </div>
                    <div class="reaction-bar">
                        <ul>
                            <li>
                                <span class="check-mark pointer"></span>
                            </li>
                            <li>
                                <span class="thumbs-up pointer"></span>
                            </li>
                            <li>
                                <span class="emoji pointer" #emojiTriggerAtRight (click)="showEmojiPicker(0, 'right')"></span>
                            </li>
                            <li>
                                <span class="answer pointer"></span>
                            </li>
                            <li>
                                <span class="option pointer">
                                    <p class="edit-message">
                                        Nachricht bearbeiten
                                    </p>
                                </span>
                                
                            </li>
                        </ul>
                    </div>
                </div>  
            }  
        }
        

        
    </div>

</div>


<ng-template #emojiPickerTemplate>
    <app-emoji-picker (closeOverlayEmitter)="closeEmojiPickerOverlay()"></app-emoji-picker>
</ng-template>
